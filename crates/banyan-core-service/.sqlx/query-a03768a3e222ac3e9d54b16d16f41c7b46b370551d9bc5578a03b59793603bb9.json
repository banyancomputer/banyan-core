{
  "db_name": "SQLite",
  "query": "WITH current_grants AS (\n               SELECT id, storage_host_id, account_id, MAX(redeemed_at) AS most_recently_redeemed_at\n                   FROM storage_grants\n                   WHERE redeemed_at IS NOT NULL\n                   GROUP BY storage_host_id, account_id\n           )\n           SELECT sg.id AS storage_grant_id, sg.authorized_amount, sh.name AS storage_host_name, sh.url AS storage_host_url\n               FROM buckets AS b\n               JOIN metadata AS m ON m.bucket_id = b.id\n               JOIN storage_hosts_metadatas_storage_grants AS shms ON shms.metadata_id = m.id\n               JOIN storage_hosts AS sh ON sh.id = shms.storage_host_id\n               JOIN storage_grants AS sg ON sg.id = shms.storage_grant_id\n               JOIN current_grants AS cg ON cg.id = sh.id\n               WHERE b.account_id = $1\n                   AND b.id = $2\n                   AND m.state NOT IN ('deleted', 'upload_failed');",
  "describe": {
    "columns": [
      {
        "name": "storage_grant_id",
        "ordinal": 0,
        "type_info": "Text"
      },
      {
        "name": "authorized_amount",
        "ordinal": 1,
        "type_info": "Int64"
      },
      {
        "name": "storage_host_name",
        "ordinal": 2,
        "type_info": "Text"
      },
      {
        "name": "storage_host_url",
        "ordinal": 3,
        "type_info": "Text"
      }
    ],
    "parameters": {
      "Right": 2
    },
    "nullable": [
      false,
      false,
      false,
      false
    ]
  },
  "hash": "a03768a3e222ac3e9d54b16d16f41c7b46b370551d9bc5578a03b59793603bb9"
}
